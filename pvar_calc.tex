
% Filosofinis klausimas - gal galima irodineti lenteles forma?
% lentele nebutina, tiesiog tokia forma, kur aiskiai matosi lygmenys. 

\documentclass[12pt, a4paper]{article}

\usepackage[utf8]{inputenc}

\usepackage{lmodern}
\usepackage{layouts}                    % layouto vienetu transformacijos  
\usepackage[hyperref]{ntheorem}         % leidzia pakesti theoremu stiliu

\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{listings}            % graziam kodui
\usepackage{enumerate}



% \usepackage{caption}                    % paveikleliu dejimas i veina vieta
% \usepackage{subcaption}                 % paveikleliu dejimas i veina vieta


% \usepackage{microtype}				          % isjungia triukus, kuriu nereikia
% \DisableLigatures[f]{encoding = *, family = * }

\usepackage{ifpdf}
\ifpdf
\usepackage{pdfpages}
\usepackage[pdftex]{hyperref}
\fi

\usepackage{color}
\definecolor{mygreen}{rgb}{0,0.6,0}
\definecolor{mygray}{rgb}{0.5,0.5,0.5}
\definecolor{FontGray}{rgb}{0.96,0.96,0.96}
\definecolor{mymauve}{rgb}{0.58,0,0.82}

\definecolor{tbred}{rgb}{1,0.6,0.6}
\definecolor{tbgreen}{rgb}{0.6,1,0.6}


\lstset{ %
  backgroundcolor=\color{FontGray},   % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
  basicstyle=\footnotesize,        % the size of the fonts that are used for the code
  breakatwhitespace=false,         % sets if automatic breaks should only happen at whitespace
  breaklines=true,                 % sets automatic line breaking
  captionpos=b,                    % sets the caption-position to bottom
  commentstyle=\color{mygreen},    % comment style
  deletekeywords={...},            % if you want to delete keywords from the given language
  escapeinside={\%*}{*)},          % if you want to add LaTeX within your code
  extendedchars=true,              % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
  frame=single,                    % adds a frame around the code
  keepspaces=true,                 % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
  keywordstyle=\color{blue},       % keyword style
  language=R,                      % the language of the code
  morekeywords={*,...},            % if you want to add more keywords to the set
  numbers=left,                    % where to put the line-numbers; possible values are (none, left, right)
  numbersep=5pt,                   % how far the line-numbers are from the code
  numberstyle=\tiny\color{mygray}, % the style that is used for the line-numbers
  rulecolor=\color{black},         % if not set, the frame-color may be changed on line-breaks within not-black text (e.g. comments (green here))
  showspaces=false,                % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
  showstringspaces=false,          % underline spaces within strings only
  showtabs=false,                  % show tabs within strings adding particular underscores
  stepnumber=1,                    % the step between two line-numbers. If it's 1, each line will be numbered
  stringstyle=\color{mymauve},     % string literal style
  tabsize=2,                       % sets default tabsize to 2 spaces
  title=\lstname                   % show the filename of files included with \lstinputlisting; also try caption instead of title
}
 
 
 
% stanratiniu fontu nustatymas
% \renewcommand{\sfdefault}{uhv}
% \renewcommand{\rmdefault}{utm}
% \renewcommand{\ttdefault}{ucr}


\theorembodyfont{\normalfont}
\theoremseparator{.}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{corollary}[theorem]{Corollary}


\newenvironment{proof}[1][Proof]{\noindent \textbf{#1.} }{\  \rule{0.5em}{0.5em}}
\numberwithin{equation}{section}

\title{The calculus of $p$-variation }



\begin{document}
  \maketitle


\begin{itemize}  
  \item $PP[a,b]$ --  the set of all point partitions of $[a,b]$ (def.~\ref{def:pp}).
  \item $s_{p}(f;\kappa)$ --  $p$-variation sum (def.~\ref{def:pvar}).
  \item $v_{p}\left( f\right)$ -- $p$-variation of the function $f$ (def.~\ref{def:pvar}).
  \item $MP_{p}(f,[a,b])$ -- the set of meaningful partitions (def.~\ref{def:pvar}).
  \item $PM[a,b]$ -- a set of piecewise monotone functions (def.~\ref{def:PM}).
  \item $CPM[a,b]$ -- a set of continuous piecewise monotone functions (def.~\ref{def:PM}).
  \item $K(f,[a,b])$ -- minimal size of PM partitions (prop.~\ref{prop:K_f}).
  \item $X(f,[a,b])$ -- the set of PM partitions with minimal size (def.~\ref{def:X_f}).
  \item $\overline{BP}(f,[a,b])$ -- the set of break points (definition \ref{def:BreakPoint}).
  \item $\overline{BP}(f,(a,b))$ -- the set of inner break points (def.~\ref{def:BreakPoint}).
  \item $BP(f,[a,b])$ -- the set of partitions that contains only break points (def.~\ref{def:BreakPoint}). 
  \item $BP(f,(a,b))$ -- the set of partitions that contains only break points, but excludes the partition $\{a,b\}$. (def.~\ref{def:BreakPoint}). 
  \item $\overline{MB}_{p}(f,[a,b])$ -- the set of meaningfully break points (def.~\ref{def:MB} ).
  \item $MB_{p}(f,[a,b])$ -- the set of partitions that contains only meaningfully break points (def.~\ref{def:MB} ).
\end{itemize}   

%Turning points
%lap - the monotonic interval
%corner
%local extrema
%forward (backward) maximum (minimum) (extrema) 

\section{Mathematical analysis}

\subsection{General known properties}
  
  
%%% Definition of partition %%% 
% Status
\begin{definition}[Partition]\label{def:pp}
  Let $J = [a,b]$ be a closed interval of real numbers with 
  $-\infty < a \leq b <+\infty$. 
  If $a < b$, an ordered set $\kappa = \{x_{i}\}_{i=0}^{n}$ 
  of points in $[a,b]$ such that a  
  $a=x_{0}<x_{1}<x_{2}<...<x_{n}=b$ is called a \emph{(point) partition}. 
  The size of the partition is denoted $\left|\kappa \right| :=\#\kappa-1=n$. 
  The set of all point partitions of $[a,b]$ is denoted by $PP[a,b]$.  
\end{definition} 
 
%%% Definition of $p$-variation %%% 
% Status:OK
\begin{definition}[$p$-variation]\label{def:pvar}
  Let $f:[a,b] \rightarrow \mathbb{R}$ be a real function from 
  an interval $[a,b]$.
  If $a<b$, for  $\kappa =\{x_{i}\}_{i=0}^{n} \in PP[a,b]$ 
  the \emph{$p$-variation sum} is 
  \begin{equation}\label{eq:def_pvarsum}
    s_{p}(f,\kappa):=\sum_{i=1}^{n}| f( x_{i}) -f( x_{i-1})|^{p},
  \end{equation}
  where $0<p<\infty $. Thus, the \emph{$p$-variation} 
  of $f$ over $[a,b]$ is $0$ if $a = b$ and otherwise
  \begin{equation}\label{eq:def_pvar}
    v_{p}(f) =v_{p}(f,[a,b]) :=\sup \left\{
    s_{p}(f,\kappa ):\kappa \in PP[a,b]\right\}.    
  \end{equation}
  
  The partition $\kappa$ is called \emph{supreme partition} 
  if it satisfies the property $v_{p}(f) = s_{p}(f,\kappa)$.
  The set of such partitions is denoted
  $SP_{p}(f,[a,b])$.
  
\end{definition}  
 
%%% THe properties of $p$-variation %%% 
% Status:OK 
\begin{lemma}[Elementary properties]\label{lm:element_properties} 
  Let $f:[a,b] \rightarrow \mathbb{R}$ and $0<p<\infty $. 
  Then the following $p$-variation properties holds
  \begin{enumerate}[a)]
    \item \label{lm:ep_a} $ v_p(f,[a,b]) \geq 0 $,
    \item \label{lm:ep_b} $ v_p(f,[a,b]) = 0 \Leftrightarrow f \equiv Const. $,
    \item \label{lm:ep_c} $ \forall C \in \mathbb{R}: v_p(f+C,[a,b]) = v_p(f,[a,b]) $,  
    \item \label{lm:ep_d} $ \forall C \in \mathbb{R}: v_p(Cf,[a,b]) = C^p v_p(f,[a,b]) $,  
    \item \label{lm:ep_e} $ \forall c \in [a,b]: v_p(f,[a,b]) \geq v_p(f,[a,c]) + v_p(f,[c,b]) $,  
    \item \label{lm:ep_f} $ \forall [a',b'] \subset [a,b] : v_p(f,[a,b]) \geq v_p(f,[a',b']) $.  
    \item \label{lm:ep_g} $ \forall \kappa \in PP[a,b]:s_{p}(f;\kappa) \leq v_p(f,[a,b]) $.  
  \end{enumerate}

  All listed properties are elementary derived directly form the $p$-variation definition.
\end{lemma}
 
 

%%% Regulated function (definition) %%% 
% Status:OK  
\begin{definition}[Regulated function](\cite{Qian}, Def. 3.1)
  For any interval $J$, which may be open or closed at either end, 
  real function $f$ is called \emph{regulated} on $J$ 
  if it has left and right limits   
  $f(x-)$ and $f(x+)$ respectively at each point $x$ in interior of $J$,
  a right limit at the left end point and a left limit 
  at the right endpoint.
\end{definition}  
 
%%% Limit points %%% 
% Status:OK   
\begin{proposition}(\cite{Qian}, Lemma 3.1)\label{prop:LimPoints} 
  Let $1 \leq p < \infty$. If $f$ is regulated then $v_{p}(f)$ remains the same
  if points $x+$, $x-$ are allowed as partition points $x_i$ in the definition \ref{def:pvar}.
\end{proposition}  
 
%%% Piecewise monotone functions (definition) %%% 
% Status:OK    
\begin{definition}[Piecewise monotone functions](\cite{Qian}, Def. 3.2)\label{def:PM}
  A regulated real-valued function $f$ on closed interval $[a,b]$ 
  will be called \emph{piecewise monotone} (PM)
  if there are points $a=x_0<\dots<x_k=b$ for some finite $k$ such 
  that $f$ is monotone on each interval $[x_{j-1},x_j],\;j=1,\dots,k$. 
  Here for $j=1,\dots,k-1$, $x_j$ may be point $x-$ or $x+$.
  The set of all piecewise monotone functions is denoted $PM=PM[a,b]$.
  
  In addition to PM, if $f$ is continuous function we will call it 
  continuous piecewise monotone(CPM). 
  The set of such functions is denoted $CPM=CPM[a,b]$. 
\end{definition}   


 
%%% Minimal size of the partitions %%% 
% Status:OK    
\begin{proposition}(\cite{Qian}, Prop. 3.1)\label{prop:K_f}
  If $f$ is PM, there is a minimal size of partition $|\kappa|$ for which the definition \ref{def:PM} holds.
  The minimal size of the the PM partition is denoted $K(f,[a,b])=K(f)$, namely
  \begin{equation}
  K(f):=\min\left\{n:\exists \{x_{i}\}_{i=0}^{n} \in PP[a,b]:  f \text{ is monotonic in each } [x_{j-1}, x_j]   \right\}.
  \end{equation}
\end{proposition}    
 
%%% The set of minimal partitions %%% 
% Status:OK  
\begin{definition}[The set of PM partitions with minimal size](\cite{Qian}, Def. 3.3)\label{def:X_f}
  If $f$ is PM, let $X(f)=X(f,[a,b])$ be the set of all $\{x_{i}\}_{i=0}^{K(f)}$ for which the definition 
  of PM (def.~\ref{def:PM}) holds. $X(f)$ is called the \emph{set of PM partitions with minimal size}.
\end{definition}    
 
%%% uniqueness of difference of PM partition %%%
% Status:OK  
\begin{proposition}(\cite{Qian}, Prop. 3.3)\label{prop:PM_Unique}
  Let $f$ is PM then the numbers 
  $\alpha_j(f):=f(x_j) - f(x_{j-1})$ for
  $\{ x_j \}_{j=0}^{K(f)} \in X(f)$ and 
  $j=1,2,\dots K(f)$
  are uniquely determined.
\end{proposition}  
 
 
%%% Equality by PM %%% 
% Status:OK 
\begin{definition}[The equality by PM](\cite{Qian}, Def. 3.4)\label{def:EqPM}
  If $f$, $g$ are two PM functions, possibly on different intervals, such that 
  $K(f)=K(g)$ and $\alpha_j(f)=\alpha_j(g)$ for $j=1,2,\dots,K(f)$, then we say that
  $f \stackrel{PM}{=} g$.
\end{definition}    
  
%%% f {DM}= g %%%
% Status:OK 
\begin{proposition}(\cite{Qian}, Cor. 3.1)\label{prop:f_PM_g}
  Let $p>1$ and functions $f$ and $g$ are PM. 
  If $f \stackrel{PM}{=} g$ or $f \stackrel{PM}{=} -g$, then $v_p(f)=v_p(g)$.
\end{proposition} 

%%% Exists meaningful partition in set of PM partition. %%%
% Status:OK 
\begin{proposition}(\cite{Qian}, Them. 3.1)\label{prop:sup_in_PM}
  Let $f$ is PM, $\kappa \in X(f)$ and $1 \leq p < \infty$. 
  Then the supremum of $p$-variation in Definition~\ref{def:pvar}
  is attained for some partition $r \subset  \kappa$.
\end{proposition} 
\begin{corollary}\label{cor:MPNotEmty}
  The set $SP_{p}(f,[a,b])$ is not empty for all $f \in PM[a,b]$.  
\end{corollary}


%%% Sample function (definition) %%%
% Status:OK 
\begin{definition}[Sample function]\label{def:Seq2Fun}
  Suppose $X=\{X_{i}\}_{i=0}^{n}$ is any sequence real numbers. 
  We will call such sequence a \emph{sample}, 
  whereas $n$ will be referred to as a \emph{sample size}.
  Then the \emph{sample function}  
  $G_X:[0,n] \rightarrow \mathbb{R}$ is defined as 
  \begin{eqnarray}
    G_X(t) := X_{\lfloor t \rfloor},\;t\in[0,n],
  \end{eqnarray}
  where $\lfloor t \rfloor$ denotes floor function at point $t$. 
\end{definition} 

%%% $p$-variation of the sequence (definition) %%%
% Status:OK 
\begin{definition}[$p$-variation of the sequence]\label{def:pvarseq}
  Let $X=\{X_i\}_{i=0}^n$. The $p$-variation
  of the sample $X$ is defined as $p$-variation of the 
  function $G_X(t)$, namely
  \begin{equation}
    v_p(X) := v_p(G_X(t),[0,n]).
  \end{equation}
\end{definition}

%%% $p$-variation of the sequence (definition) %%%
% Status:??? 
\begin{definition}[Piecewise linear function]\label{def:poligon}
  Let $X=\{X_i\}_{i=0}^n$ be any real-value sequence. 
  The function $L_X:[0,n] \rightarrow \mathbb{R}$ is defined as
  \begin{eqnarray}
  L_X(t) := (1+\lfloor t \rfloor-t)X_{\lfloor t \rfloor} + (t-\lfloor t \rfloor)X_{\lfloor t \rfloor+1}   ,\;t\in[0,n]
  \end{eqnarray}
  is called \emph{piecewise linear function}.
\end{definition}

%%% Partial sum (definition) %%%
% Status:OK 
\begin{definition}[Partial sum]
  Let $X_1, X_2,\dots,X_n$ be any sequence of real numbers. 
  The \emph{partial sum} of the first $j$ terms is defined by  
  \begin{equation}
    S_j:=\sum_{i=1}^j X_i, \; j=1,2,\dots,n.
  \end{equation}
  In addition, lets denote $S_0=0$.  
\end{definition}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{General properties with proofs}


%%% For all PM exists CPM that v(PM)=v(CPM) %%%
% Status: OK
\begin{proposition}\label{prop:PM2CPM}
  For all $f \in PM$ exists $g \in CPM$ such that $f \stackrel{PM}{=} g$.
\end{proposition} 
\begin{proof}
  Let $f$ be PM. According to Proposition~\ref{prop:PM_Unique} the
  numbers $\alpha_j(f):=f(x_j) - f(x_{j-1})$, $j=1,2,\dots K(f)$
  are uniquely determined.
  Then, the partial sums of the sequence $\alpha_j(f)$ are
  \begin{equation}
    S_j:=\sum_{i=1}^j \alpha_i(f).
  \end{equation}    

  Lets connect points $S_j$ by 
  piecewise linear function~(def.~\ref{def:poligon}), namely
  \begin{equation}
  L_S(t) := (1+\lfloor t \rfloor-t)S_{\lfloor t \rfloor} + (t-\lfloor t \rfloor)S_{\lfloor t \rfloor+1}   ,\;t\in[0,K(f)]
  \end{equation}  
   
  Function $L_S$ is CPM. In addition, 
  it is straight forward to see that 
  \begin{equation}
  \alpha_j(L_S)=S_j-S_{j-1}=\alpha_j(f),
  \end{equation}
  hence, by Definition~\ref{def:EqPM} $f \stackrel{PM}{=} L_S$.  
\end{proof}

\begin{corollary}\label{cor:PM2CPM}
  By applying last proof to the function 
  $G_X(t)$ (from Definition~\ref{def:Seq2Fun}), we get that 
  \begin{equation}
    G_X(t)\stackrel{PM}{=}L_X(t).
  \end{equation}
  Therefore, according to Proposition~\ref{prop:f_PM_g}, if $p>1$ then
  \begin{equation}
    v_p(X) := v_p(G_X(t),[0,n])= v_p(L_X(t),[0,n])
  \end{equation}
\end{corollary}


%%% VIP: p-variation is additive in meaningful points %%%
% Status: 
\begin{proposition}\label{prop:pvar_sum_x} 
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM.
  Let $\{x_i\}_{i=0}^n \in PP[a,b]$ be any partition of interval $[a,b]$. 
  Then the statement 
  \begin{equation}
    \exists \kappa \in SP_{p}(f,[a,b]):\forall i,x_i \in \kappa
  \end{equation}
  is equivalent to 
  \begin{equation}
    v_p(f,[a,b]) = \sum_{i=1}^n v_p(f,[x_{i-1},x_i]).
  \end{equation}
\end{proposition}
\begin{proof}
  Necessary. Let $f:[a,b] \rightarrow \mathbb{R}$ be $CPM$,
  $\{x_i\}_{i=0}^n \in  PP[a,b]$ and 
  \begin{equation}
    \exists \kappa \in SP_{p}(f,[a,b]):\forall i,x_i \in \kappa. 
  \end{equation}
  
  Points from the partition $\kappa$ will be denoted $t_i$, i.e. $\kappa=\{t_i\}_{i=0}^m$.
  Then, according to definitions of $SP_{p}$ and $p$-variation (def.~\ref{def:pvar}) the following equation holds
  \begin{equation}\label{eq:ir1.eq1}
  v_p(f,[a,b])=s_{p}(f;\kappa)=\sum_{j=1}^{m}|f(t_{j-1})-f(t_j)|^p 
    = \sum_{i=1}^n\sum_{j=h(i-1)+1}^{h(i)}|f(t_{j-1})-f(t_j)|^p,
  \end{equation}  
  where $h:\{0,1,\dots,n\} \rightarrow \{0,1,\dots,m\}$ denotes a function 
  from the set of index of $x$ to the set of index of $t$, namely:
  \begin{equation}\label{eq:ir1.eqx1}
    h(i):=(j_i : x_i = t_{j_i}=t_{h(i)}).
  \end{equation}  
  The equation (\ref{eq:ir1.eq1}) holds, because all the elements 
  in the sum remains, we just grouped them.
  
  Moreover, the inequality  
  \begin{equation}\label{eq:ir1.eq2}
  \sum_{j=h(i-1)+1}^{h(i)}|f(t_{j-1})-f(t_j)|^p \leq v_p(f,[x_{i-1},x_i])
  \end{equation}  
  holds according to Lemma \ref{lm:element_properties}(\ref{lm:ep_g}).
  
  As a result of (\ref{eq:ir1.eq1}) and (\ref{eq:ir1.eq2}) we get
  \begin{equation}\label{eq:ir1.eq3}
    v_p(f,[a,b]) \leq \sum_{i=1}^n v_p(f,[x_{i-1},x_i]).
  \end{equation}
  
  On the other hand, according to the same Lemma~\ref{lm:element_properties}(\ref{lm:ep_e}) the following inequality holds
  \begin{equation}\label{eq:ir1.eq4}
    v_p(f,[a,b]) \geq \sum_{i=1}^n v_p(f,[x_{i-1},x_i]).
  \end{equation}
  
  Finally, from the (\ref{eq:ir1.eq3}) and (\ref{eq:ir1.eq4}) follows 
  \begin{equation}\label{eq:ir1.eq5}
    v_p(f,[a,b]) = \sum_{i=1}^n v_p(f,[x_{i-1},x_i]).
  \end{equation}
  
  Sufficiency. Suppose $f:[a,b] \rightarrow \mathbb{R}$ is $CPM$ and 
  \begin{equation}\label{eq:ir1.eq6}
    v_p(f,[a,b]) = \sum_{i=1}^n v_p(f,[x_{i-1},x_i]).
  \end{equation}
  
  According to Corollary~\ref{cor:MPNotEmty}, 
  sets $SP_{p}(f,[x_{i-1},x_i]),\;i=1,\dots,n$ are not empty.  
  Lets take any partition from each of the 
  sets $SP_{p}(f,[x_{i-1},x_i]),\;i=1,\dots,n$ and denote it $\kappa_i$.
    
  
  Then, let define a joint partition $\kappa:=\cup_{i=1}^n \kappa_i$. 
  Points from the partition $\kappa$ will be denoted by $t_i$. 
  In addition, we will use the function $h$, which is defined in (\ref{eq:ir1.eqx1}).
  Then, continuing the equation (\ref{eq:ir1.eq6}) we get
  \begin{equation}\label{eq:ir1.eq7}
  v_p(f,[a,b]) = \sum_{i=1}^n\sum_{j=h(i-1)+1}^{h(i)}|f(t_{j-1})-f(t_j)|^p
    =\sum_{i=1}^{|\kappa|}|f(t_{i-1})-f(t_i)|^p.
  \end{equation}
  This means that $\kappa \in MP_{p}(f,[a,b])$. Moreover, $\forall i:x_i \in \kappa$,
  because $\kappa=\cup_{i=1}^n \kappa_i$.  
\end{proof}

\subsection{Meaningful break points}

%%% Lexicographical order (definition %%%
% Status: OK
\begin{definition}[Lexicographical order]\label{def:LexiOrder}
  Suppose $f$ is CPM. Let $\kappa$ and $r$ denotes two partitions with minimal size, namely
  $\kappa=\{x_j\}_{j=0}^{K(f)}\in X(f)$ 
  and $r=\{ y_j \}_{j=0}^{K(f)}\in X(f)$.
  Then partitions $\kappa$ and $r$ could be compare using \emph{lexicographical order}, namely
  we will say that $\kappa \succ r$, if 
  \begin{itemize}
    \item $\exists j: x_j > y_j$; and
    \item $\forall i<j: x_i = y_i$.
  \end{itemize} 
  We will say $\kappa = r$ if $\forall j:x_j=y_j$.\\
  We will say $\kappa \succeq r$ if $\kappa \succ r$ or $\kappa = r$.
\end{definition}


%%% Lexicographical order is total %%%
% Status: Need reference
\begin{proposition}
  Binary relation $\succeq$ is a total order, 
  i.e. the relationship $\succeq$ satisfies the flowing properties 
  for all $\kappa,r,g \in  X(f)$:
  \begin{itemize}
    \item Antisymmetry -- if $\kappa \succeq r$  and $r\succeq \kappa$,
     then $\kappa=r$.
    \item Transitivity -- if  $\kappa \succeq r$  and $r \succeq g$,
     then $\kappa\succeq g$.
    \item Totality -- either $\kappa \succeq r$ or $r\succeq \kappa$.
  \end{itemize}

\end{proposition}
\begin{proof}  
   Need reference ...
\end{proof}  

%%% Exists maximal element %%%
% Status: OK
\begin{proposition} \label{prop:kappaf}
  Let $f:[a,b] \rightarrow \mathbb{R}$ is CPM. Then there is a partition  
  $\kappa_f \in  X(f)$ such that
  \begin{equation}\label{eq:Kappaf}
    \forall r \in X(f): \kappa_f \succeq r .
  \end{equation}
\end{proposition}
\begin{proof}  
  Firstly, we will construct $\kappa_f$, latter, we will proof
  that the property (\ref{eq:Kappaf}) holds.
  
  Suppose,  $f:[a,b] \rightarrow \mathbb{R}$ is CPM. Let denote
  \begin{equation*}
    x_1:=\sup \left\{x\in[a,b]:|f(y_1)-f(a)| \leq |f(y_2)-f(a)|, \forall a \leq y_1 < y_2 \leq x \right\}.
  \end{equation*} 
  
  Other $x_i,\;i=2,\dots,K(f)$ will be defined by induction. 
  Suppose $x_{i-1}$ is defined and $x_{i-1}<b$, then 
  \begin{equation*}
    x_i:=\sup \left\{x\in[x_{i-1},b]:|f(y_1)-f(x_{i-1})| \leq |f(y_2)-f(x_{i-1})|, \forall x_{i-1} \leq y_1 < y_2 \leq x \right\}.
  \end{equation*}   
  
  According condition used in the definition of $x_i$,
  all $(x_{i-1},x_i),\;i=1,\dots,K(f)$ are monotonic intervals.

  In addition, points $x_i$ have the greatest values, 
  that satisfies the condition. 
  Therefore, if the values $x_i$ would increased,
  the condition would no longer be valid, i.e.   
  \begin{equation}\label{eq:KapaS.1}
   \forall i, \exists \delta: |f(x_i)-f(x_{i-1})|> |f(x_i+\varepsilon)-f(x_{i-1})|\text{, if } \varepsilon \in (0,\delta). 
  \end{equation}   
  
  We will show that  $\kappa_f:=\{x_i\}_{i=1}^{n}$
  satisfies the condition  (\ref{eq:Kappaf}). 
  Suppose to the contrary that
  \begin{equation}
   \exists r=\{t_i\}_{i=1}^{n} \in X(f): r \succ \kappa_s.
  \end{equation}    
  According to Definition of $\succ$ we get
  \begin{equation}
   \exists j: t_j>x_j\text{, and } t_i=x_i \text{, if } i<j.
  \end{equation}     
  
  Since $r \in X(f)$, the intervals $[t_{j-1}, t_j]$ 
  are monotonic intervals, i.e.
  \begin{equation}\label{eq:KapaS.2}
    |f(y_1)-f(t_{j-1})| \leq |f(y_2)-f(t_{j-1})|,
  \end{equation}      
  if $t_{j-1} \leq y_1 < y_2 \leq t_j$.
  But (\ref{eq:KapaS.2}) contradicts (\ref{eq:KapaS.1}), then
  $y_1=x_j$ and $y_2=x_j+\varepsilon$.  
\end{proof}     
  
%% f:[BP_1,BP_2] -> R is not a constant.
% Status: OK
\begin{lemma}\label{lem:noncons}
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM and $\kappa_f=\{x_i\}_{i=1}^{K(f)}$ 
  is the partition from (\ref{eq:Kappaf}).
  Then, for all $x_i,i=1,\dots,K(f)-1$, the following proposition holds
  \begin{equation}
    \forall \varepsilon>0: f \text{ is not a constant in } [x_i,x_i + \varepsilon].
  \end{equation}
\end{lemma}
\begin{proof} 
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM and $\kappa_f=\{x_i\}_{i=1}^{K(f)}$ 
  is the partition from (\ref{eq:Kappaf}).
  Suppose to the contrary, that exists $x_j$ and $\varepsilon > 0$ such that
  $f \text{ is not a constant in } [x_j,x_j + \varepsilon]$.
  Since $f$ is constant in $[x_j,x_j + \varepsilon]$,
  the point $x_j + \varepsilon$ is also the end of monotone interval (def.~\ref{def:PM}).
  
  Lets define the partition $\{y_i\}_{i=1}^{K(f)} \in X(f)$, which is
  \begin{equation}
    y_i :=
    \begin{cases}
      x_i & \text{, if } j \neq i \\
      x_i+\varepsilon  & \text{, if } j = i
    \end{cases},
  \end{equation}
  where $\varepsilon \in (0, x_{j+1}-x_j)$.
  
  It is straight forward to see that $\{y_i\}_{i=1}^{K(f)} \succ \kappa_f$, since
  $y_j>x_j$ and $y_i=x_i,i<j$. 
  This contradict the definition of $\kappa_f$. 
\end{proof}   
  
  
%%% Break points (definition) %%%
% Status:OK  
\begin{definition}[Break points]\label{def:BreakPoint}
  Let $\kappa_f$ be a partition form Proposition~\ref{prop:kappaf}.  
  The points $x_j \in \kappa_f$ will be called \emph{break points} 
  and the set of such points are denoted $\overline{BP}(f,[a,b])$, which is non empty and finite.
  The set of partitions that contains only break points are denoted $BP(f,[a,b])$, i.e.
  \begin{equation}
    BP(f) = BP(f,[a,b]) := \left\{\kappa \in PP[a,b]: \kappa \subset \overline{BP}(f,[a,b]) \right\}. 
  \end{equation}
  $BP(f,[a,b])$ is also non empty and finite.
  
  For the convenience let define the subsets of the sets $\overline{BP}$ and $BP$ 
  that excludes the ends of the interval, namely
  \begin{eqnarray}
    \overline{BP}(f,(a,b)) &:=& \overline{BP}(f,[a,b])\setminus \{a,b\}, \\
    BP(f,(a,b)) &:=& BP(f,[a,b])\setminus \{\{a,b\}\}.  \label{eq:BP(f,(a,b))}
  \end{eqnarray}
\end{definition}  
  
 
  
%%% meaningul partition ar in break points %%%
% Status: OK
\begin{proposition}\label{prop:pvar-max}
  Let $f$ is CPM function defined in $[a,b]$ and $1 \leq p < \infty$.
  Then the $p$-variations could be expressed as 
  \begin{equation}
    v_{p}\left( f\right) =v_{p}\left( f,[a,b]\right) =\max \left\{
    s_{p}(f;\kappa ):\kappa \in BP(f,[a,b]) \right\}.
  \label{pv1}
  \end{equation}
\end{proposition}
\begin{proof}
  This result follows directly from the Proposition~\ref{prop:sup_in_PM}.
\end{proof} 




%%% Meaningfull break points (definition) %%%
% Status: OK
\begin{definition}[Meaningfull break points]\label{def:MB} 
  Suppose $f$ is CPM and $1 \leq p < \infty$. 
  Let denote the set of \emph{partitions of meaningful break} (points)
  \begin{equation}
    MB_{p}(f) = MB_{p}(f,[a,b]):= MP_p(f,[a,b]) \cap BP(f, [a,b]).
  \end{equation}  
  The set $MB_{p}(f,[a,b])$ is not empty according to Proposition~\ref{prop:pvar-max}.
  
  The point $x$ will be called \emph{meaningful break} if $\exists \kappa \in MB_{p}(f): x \in \kappa$.
  The set of such points are denoted $\overline{MB}_p(f) = \overline{MB}_p(f,[a,b])$.
  The point $a$ is called \emph{meaningless} if 
  $a \notin \overline{MB}_{p}(f,[a,b]) $. 
\end{definition}

%%% The interval on meaningful breaks are additive in all possible combinations %%%
% Status: OK
\begin{lemma}\label{prop:pvarSubset}
  Let $\{x_i\}_{i=0}^{n} \subset \kappa \in MB_{p}(f,[a,b])$, then
  \begin{equation}
    \forall i,j: v_p(f,[x_i,x_j])= \sum_{k=i+1}^j v_p(f,[x_{k-1},x_k]),\; 0 \leq i<j\leq n. 
  \end{equation}
\end{lemma}
\begin{proof}
  Suppose $\{x_i\}_{i=0}^{n} \subset \kappa \in MB_{p}(f,[a,b])$. 
  Let choose $i$ and $j$ such that $0\leq i<j\leq n$.
  Because $MB_{p} \subset MP_{p}$, we can apply Proposition \ref{prop:pvar_sum_x} for the partition
  $\{x_0,x_i,x_{i+1},\dots,x_{j-1},x_j,x_n\}$. Thus,
  \begin{equation}
    v_p(f,[a,b]) = v_p(f,[x_{0},x_i]) + \sum_{k=i+1}^j v_p(f,[x_{k-1},x_k]) + v_p(f,[x_j,x_n]). 
  \end{equation}
  In addition, we can apply the same proposition for the partition $\{x_0,x_i,x_j,x_n\}$, then
  \begin{equation}
    v_p(f,[a,b]) =  v_p(f,[x_{0},x_i]) + v_p(f,[x_i,x_j]) + v_p(f,[x_j,x_n]). 
  \end{equation}
  By subtracting one equation form the other we get the result that
  \begin{equation}
    v_p(f,[x_i,x_j])= \sum_{k=i+1}^j v_p(f,[x_{k-1},x_k]). 
  \end{equation}
\end{proof}


%%% Exists partition from MB with maximum size %%%
% Status: OK
\begin{proposition}\label{prop:EMaxKappa}  
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM. Then
  \begin{equation}\label{eq:MaxKappa}
    \exists \kappa_{ab} \in MB_{p}(f,[a,b]): \forall \kappa \in MB_{p}(f,[a,b]) [|\kappa_{ab}| \geq |\kappa|].
  \end{equation}  
\end{proposition}
\begin{proof}
  Suppose $f$ is CPM, then $\forall \kappa \in BP(f): |\kappa| \leq K(f)$.
  Since $MB_{p}(f) \subset BP(f)$, then $\forall \kappa \in MP_{p}(f): |\kappa|\leq K(f)$. 
  Therefore, the size of partitions from $MP_{p}(f)$ are bounded.
  As a result the size of the partition $|\kappa|$ is bounded natural number, 
  whereas such set has the larges element.
\end{proof}

%%% The partition of MB with maximum size (definition) %%%
% Status: OK
\begin{definition} \label{def:MB^m} 
  The set of partitions $\kappa_{ab}$ which satisfies \ref{eq:MaxKappa}
  will be denoted $MB_{p}^m(f,[a,b])=MB_{p}^m(f)$.  
  This set is non empty according to Proposition~\ref{prop:EMaxKappa}.

  In addition it could be shown (see Proposition~\ref{prop:E1Kappa}) 
  that the set $MB_{p}^m(f)$ has exactly one element and 
  \begin{equation}
    \forall \kappa \in MB_{p}(f):\kappa \subset \kappa_{ab} \in MB_{p}^m(f)
  \end{equation}
\end{definition}

%%% MP^m <=> p-variation => f-join %%%  
% Status: Need subtlety in proof
\begin{lemma}\label{lem:MinJunktSal} 
  Let $f$ is $CMD$. Then $\{a,b\} \in MB_{p}^m(f,[a,b])$
  if and only if
  \begin{equation*}
    \forall \kappa \in BP(f,(a,b)): v_p(f,[a,b]) > s_p(f, \kappa).
  \end{equation*} 
  Here the $BP(f,(a,b))$ is the set of partitions of break points
  excluding $\{a,b\}$ (see def.~\ref{eq:BP(f,(a,b))}).
\end{lemma}
\begin{proof} 
  Necessary. Let assume on the contrary that $\{a,b\} \in MP_{p}^m(f,[a,b])$, but
  \begin{equation*}
     \exists \kappa \in BP(f,(a,b)): v_p(f,[a,b]) = s_p(f, \kappa).
  \end{equation*} 
  
  The partition $\kappa \in BP(f,(a,b))$ must have more points then the end of the intervals $a$ and $b$,
  because if $\kappa = \{a,b\}$ then it contradicts to the definition of $BP(f,(a,b))$.
  Therefore, $|\kappa|>|\{a,b\}|$, but this contradicts to assumptions that $\{a,b\} \in MP_{p}^m(f,[a,b])$.
  
  Sufficiency. Suppose 
  \begin{equation}\label{eq:MinJunktSal_Ir_eq1}
    \forall \kappa \in BP(f,(a,b)): v_p(f,[a,b]) > s_p(f, \kappa).
  \end{equation} 
  
  According to Proposition~\ref{prop:pvar-max}, the $p$-variation is achieved in the set $BP(f,[a,b])$, 
  therefore, from the (\ref{eq:MinJunktSal_Ir_eq1}) follows that
  $\{a,b\}$ is the partition of meaningful break points, i.e. $\{a,b\} \in MP_{p}(f,[a,b])$. 
  In addition, this partition is the only one, therefore it is the biggest partition, thus 
  $\{a,b\} \in MP_{p}^m(f,[a,b])$.
\end{proof}    


%%% The subset of MB^m is MB^m %%%
% Status: OK
\begin{lemma}\label{prop:MaxKapaJunkMax}
  Let $f:[a,b] \rightarrow \mathbb{R}$ be CPM. Suppose $\{x_i\}_{i=0}^n \in MB_{p}^m(f,[a,b])$.
  Then 
  \begin{equation}
    \forall i \in \{1,2,\dots,n\} : \{x_{i-1},x_i\} \in MB_{p}^m(f,[x_{i-1},x_i]). 
  \end{equation}
\end{lemma}
\begin{proof}
  Suppose to the contrary that
  \begin{equation}
    \exists j \in \{1,2,\dots,n\} :\{x_{j-1},x_j\}  \notin MB_{p}^m(f,[x_{j-1},x_j]).
  \end{equation}
  
  Then, according to Lemma~\ref{lem:MinJunktSal} 
  \begin{equation}
    \exists \kappa \in BP(f,(x_{j-1}, x_j)): v_p(f,[x_{j-1}, x_j]) = s_p(f, \kappa).
  \end{equation}
    
  On the other hand, from the Proposition~\ref{prop:pvar_sum_x} we get
  \begin{eqnarray*}
    v_p(f,[x_0, x_n]) &=& v_p(f,[x_0, x_{j-1}]) + v_p(f,[x_{j-1}, x_{j}]) + v_p(f,[x_j, x_n])  \\
                &=& s_p(f,\{x_i\}_{i=0}^{j-1}) + s_p(f, \kappa) +s_p(f,\{x_i\}_{i=j}^{n}).
  \end{eqnarray*}
  Thus,  $\{x_i\}_{i=0}^{j-1} \cup \kappa \cup \{x_i\}_{i=j}^{n} \in MB_{p}(f,[a,b])$.  
  Therefore, $\{x_i\}_{i=0}^n \notin MB_{p}^m(f,[a,b])$, because
  \begin{equation}
  |\{x_i\}_{i=0}^{j-1} \cup \kappa \cup \{x_i\}_{i=j}^{n}| > |\{x_i\}_{i=0}^n|,  
  \end{equation}
  This contradicts the initial assumption.
\end{proof}

\subsection{f-join}

%%% $f$-join (definition) %%%
% Status: OK
\begin{definition}[$f$-join]\label{def:fjoin}
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is $CPM$.
  We will say that points $t_a$ and $t_b$ ($t_a<t_b$) are \emph{$f$-joined} in interval $[a,b]$ if 
  \begin{equation}
    \exists \{x_j\}_{j=0}^{n} \in MB_{p}(f,[a,b]): [t_a,t_b]=[x_{j-1},x_j], \text{ with some } j.
  \end{equation}  
\end{definition}



%%% {a,b} are f-foined => v_p([a,b]) = |f(a)-f(b)|^p %%%
% Status: OK
\begin{lemma}\label{prop:fjoinPvar} 
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM and $a \leq t_a<t_b \leq b$.
  If points $t_a$ and $t_b$ are $f$-joined, then 
  \begin{equation}
    v_p(f,[t_a,t_b])=|f(t_b)-f(t_a)|^p. 
  \end{equation}
\end{lemma}
\begin{proof} 
  Let $f:[a,b] \rightarrow \mathbb{R}$ is CMD, 
  $t_a<t_b$ and points $t_a$ and $t_b$ are $f$-joined. 
  Then exists $\{x_j\}_{j=0}^{n}$ and $j$ from the Definition~\ref{def:fjoin}.
  According to definition of the $p$-variation and properties of $s_p$ function we get
  \begin{equation}
  v_p(f,[a,b])= s_p(f,\{x_i\}_{i=0}^{K(f)}) = 
     s_p(f,\{x_i\}_{i=0}^{j-1}) + s_p(f,\{x_{j-1},x_j\}) + s_p(f,\{x_i\}_{i=j}^{K(f)}).
  \end{equation}
  
  Suppose to the contrary that $\exists r \in PP_{p}(f,[x_{j-1},x_j]): s_p(f,r)>s_p(f,\{x_{j-1},x_j\})$, thus
  \begin{equation}
    v_p(f,[a,b]) < s_p(f,\{x_i\}_{i=0}^{j-1}) + s_p(f,r) + s_p(f,\{x_i\}_{i=j}^{K(f)}) = s_p(f,\kappa),
  \end{equation}
  where $\kappa:=\{x_i\}_{i=0}^{j-1} \cup r \cup \{x_i\}_{i=j}^{K(f)}$.
  The last inequality contradicts the definition of $p$-variation, 
  therefore $\{x_{j-1},x_j\}$ is the partition of meaningful break points in interval $[x_{j-1},x_j]$, thus
  \begin{equation}
    v_p(f,[x_{j-1},x_j])=s_p(f,\{x_{j-1},x_j\})=|f(x_j)-f(x_{j-1})|^p.
  \end{equation}    
\end{proof}


%%% The extremum of the function (definition) %%%
% Status: OK
\begin{definition}[Extremum]\label{def:extremum}
  We will call the point $t \in  [a,b]$ an \emph{extremum} of the function $f$ in interval $[a,b]$ if   
  $f(t)=\sup \left\{ f(z):z\in \left[ a,b\right]
  \right\} $ or $f(t)=\inf \left\{ f(z):z\in \left[ a,b\right] \right\} $.
\end{definition}

%%% Pseudo-monotonic function (definition) %%%
% Status: OK
\begin{definition}[Pseudo-monotonic function]\label{def:PsiaudoMon}
  A function $f$ is called \emph{pseudo-monotonic} in interval $[a,b]$ if
  \begin{equation}
    \forall x \in [a,b]: f(x) \in [\min(f(a),f(b)), \max(f(a),f(b))].  
  \end{equation}
\end{definition}

%%% f-joined points are extremum of inner interval %%%
% Status: OK
\begin{proposition}\label{prop:MinMax_in_fjoin}
  Let $f:[a,b] \rightarrow \mathbb{R}$ be CPM and points $t_a$ and $t_b$ are $f$-joined.
  Then points $t_a$ are $t_b$ extremums of the function in the interval $[t_a,t_b]$.
  In addition, there is no other break point $d \in BP(f, (t_a,t_b))$ that
  is an extremum of the function in the interval $[t_a,t_b]$.
\end{proposition}
\begin{proof}
  Let $f:[a,b] \rightarrow \mathbb{R}$ be CPM and points $t_a$ and $t_b$ are $f$-joined.
  Since $f \stackrel{PM}{=} -g$, with out loss of generality we can assume that
  $f(t_a) \leq f(t_b)$.  
  Suppose to the contrary that $f(t_b)$ 
  is not an extremum of the function in interval $[t_a,t_b]$.
  Hence, $\exists c \in [t_a, t_b]: f(c)>f(t_b)$. Therefore,
  $|f(c)-f(t_a)|^p>|f(t_b)-f(t_a)|^p$.
  According to Proposition \ref{prop:fjoinPvar}, 
  $v_p(f,[t_a,t_b])=|f(t_b)-f(t_a)|^p$, 
  thus, $|f(c)-f(t_a)|^p>v_p(f,[t_a,t_b])$,
  but this contradicts the definition of $p$-variation.  
  So, point $t_b$ must be an extremum in interval $[t_a,t_b]$.
  Completely symmetric arguments could be used for point $t_a$.
  
  In addition, it could be shown that if $d \in BP(f, (t_a,t_b))$, then
  $f(d) < f(t_b)$.  
  Suppose to the contrary that $\exists d \in BP(f, (t_a,t_b)): f(d) = f(t_b)$.
  Then, $|f(d)-f(t_a)|^p = |f(t_b)-f(t_a)|^p$, 
  therefore, $v_p(f,[t_a,d])=v_p(f,[t_a,t_b])$.
  Since, $v_p(f,[t_a,t_b]) \geq v_p(f,[t_a,d])+v_p(f,[d,t_b])$, 
  we get that $v_p(f,[d,t_b]) \leq 0$. 
  So, $v_p(f,[d,t_b]) = 0$, because $v_p(f,[d,t_b]) < 0$ is not valid.
  According to Lemma~\ref{lm:element_properties}(\ref{lm:ep_b}), $v_p(f,[d,t_b]) = 0$ iff function is constant in $[d,t_b]$.
  But this contradicts to the fact that $d$ is a break point (see Lemma~\ref{lem:noncons}).  
\end{proof}
\begin{corollary}\label{cor:pseudo-monotonic}
  Let $f:[a,b] \rightarrow \mathbb{R}$ be CPM and points $t_a$ and $t_b$ are $f$-joined.
  Then function is pseudo-monotonic in interval $[t_a,t_b]$. 
  So, if $f(t_a) \leq f(t_b)$, then
  \begin{equation}
    \forall x \in (t_a,t_b): f(t_a) \leq f(x) \leq f(t_b).
  \end{equation}
  In addition,  
  \begin{equation}
    \forall d \in BP(f,(a,b)):f(a)<f(d)<f(b) .
  \end{equation}
\end{corollary}
\begin{proof}
  The result follows directly from the Proposition~\ref{prop:MinMax_in_fjoin}. 
\end{proof}


%%% Global extremums are meaningful breaks %%% 
% Status: OK
\begin{proposition}\label{prop:SplitMinMax}
  Let $f:[a,b] \rightarrow \mathbb{R}$ is $CPM$. 
  If point $d \in [a,b]$ is a break point, which is an extremums of the function $f$, 
  then $d$ is a meaningful break point.
\end{proposition}
\begin{proof}
  Let $f:[a,b] \rightarrow \mathbb{R}$ is $CPM$.
  Suppose to the contrary that exists $d \in \overline{BP}(f,[a,b])$, 
  which is an extremum of the function, but
  $d \notin \overline{MB}_{p}(f,[a,b]) $.
  Let $\{x_j\}_{j=0}^{n} \in MB(f,[a,b]$ be any partition from $MB(f)$. 
  Since $d \in [a,b]$ and $d \notin \overline{MB}_{p}(f,[a,b])$,
  \begin{equation}
    \exists j \in 1,\dots,n: d \in (x_{j-1},x_j) .
  \end{equation}  
  The points $x_{j-1}$ and $x_j$ are $f$-joined and $d$ is break point, 
  hence, according Corollary~\ref{cor:pseudo-monotonic}
  \begin{equation}
    f(x_{j-1})<f(d)<f(x_j).
  \end{equation}
  But this contradicts the assumption that $d$ is the extremum.
\end{proof}


\subsection{Main result}

%%% The monotonisy of Sp function %%%
% Status: Need proof in caorollary
\begin{lemma}\label{prop:Sp_Monoton}
  Suppose $C \in \mathbb{R}$, $c_1\geq0$ and $1\leq p<\infty$. Then function
  $f:[0,\infty) \rightarrow \mathbb{R}$ with the values
  \begin{equation}
  f(x) = ( x + c_1  )^p - x^p - C,\;x \in [0,\infty),  
  \end{equation}
  are non decreasing in interval $[0,\infty)$. 
\end{lemma}
\begin{proof}
  Suppose $C \in \mathbb{R}$, $c_1\geq0$ and $1\leq p<\infty$. 
  The the derivative of the function $f$ is
  \begin{eqnarray*} 
    f'(x)   &=& p(x+c_1)^{p-1} - px^{p-1} \\
          &\geq& p(x)^{p-1} - px^{p-1} = 0.
  \end{eqnarray*}  
  The derivative of function $f$ is non negative, thus the function $f$ is non decreasing.
\end{proof}
\begin{corollary}\label{cor:convex}
  Suppose $c_1\geq0$, $1\leq p<\infty$ and $0 \leq x \leq y$. Then the following implication holds 
  \begin{equation}
  |x + c_1 |^p > x^p + C \Rightarrow |y + c_1 |^{p} > y^{p} + C.  
  \end{equation}
\end{corollary}
\begin{proof}
  Suppose  $0 \leq x \leq y$. 
  Since $f$ is non decreasing, $f(x) \leq f(y)$.
  Therefore, if $f(x)>0$, then $f(y)>0$.
\end{proof}


%%% VIP: Meaningless if in inner MP^m %%%
% Status OK
\begin{proposition}\label{prop:NotInMB}
  Let $f:[a,b] \rightarrow \mathbb{R}$ is CPM,
  $1 \leq p < \infty$, $[a',b'] \subset [a,b] $. If 
  \begin{equation}\label{eq:NotInMB1}
    \{a',b'\} \in MB_p^m(f,[a',b']),
  \end{equation}
  then
  \begin{equation}\label{eq:NotInMB2}
    \forall x \in (a',b'): x \notin \overline{MB}_p(f,[a,b])    
  \end{equation}
\end{proposition}
\begin{proof}
  Suppose to the contrary that the assumptions of the proposition is valid and    
  \begin{equation}\label{eq:NotInMB_p1}
    \exists x \in (a',b'): x \in \overline{MB}_p(f,[a,b]).
  \end{equation}
  
  According to the definition of $\overline{MB}_p(f,[a,b])$, 
  the (\ref{eq:NotInMB_p1}) means that
  \begin{equation}\label{eq:NotInMB_p3}
    \exists \{t_i\}_{i=0}^n \in MB_{p}(f,[a,b]): x \in \{t_i\}_{i=0}^n.
  \end{equation}  
  
  Moreover, 
  \begin{equation}\label{eq:NotInMB_p2} 
    x \notin \{a, a', b', b\},
  \end{equation} 
  because $x \in (a',b')$.  
  
  Thus, from (\ref{eq:NotInMB_p2}) and (\ref{eq:NotInMB_p3}) it follows that  
  \begin{equation}\label{eq:NotInMB_p4}
    \exists j \in \{1,2,\dots,n-1\} : x = t_j.
  \end{equation}  

  Lets denote variables $l$ and $k$ by
  \begin{eqnarray}
    l &:=& \max \left\{i \in \{1,2,\dots,n-1\} : t_i  \in (a',b') \right\}, \\
    k &:= &\min \left\{i \in \{1,2,\dots,n-1\} : t_i  \in (a',b') \right\}.
  \end{eqnarray}  
  Since (\ref{eq:NotInMB_p4})~holds, the values $l$ and $k$ always exists. 
  According to $l$ and $k$ definitions the following inequality holds  
  \begin{equation}\label{eq:NotInMB_p5}
    t_{k-1} \leq a' < t_{k} \leq t_{l} < b' \leq t_{l+1}.
  \end{equation}
  
  Points $a'$ and $b'$ are f-joined according to (\ref{eq:NotInMB1}), therefore,
  function $f$ is pseudo-monotonic in interval $[a',b']$. 
  Since $v_p(f)=v_p(-f)$ (see Proposition~\ref{prop:f_PM_g}), with out loss of generality 
  we can assume that interval $[a',b']$ is decreasing, i.e. 
  $$f(a') > f(b').$$  
  
  Moreover, points $t_l$ and $t_k$ are breakpoints, 
  because $\{t_i\}_{i=0}^n \in MB_{p}(f,[a,b]) \subset BP(f,[a,b])$.
  Therefore, according to Corollary~\ref{cor:pseudo-monotonic} 
  the values $f(t_{l})$ and $f(t_{k})$ can be only between $f(a')$ and $f(b')$. So,
  \begin{eqnarray}
    f(a') > f(t_{l}) > f(b'), \label{eq:NotInMB_pd1}  \\
    f(a') > f(t_{k}) > f(b'). \label{eq:NotInMB_pd2}
  \end{eqnarray}
  
  In addition, since the pairs of points $\{t_l,t_{l+1}\}$ and $\{t_k,t_{k+1}\}$ are also f-joined, 
  the inequalities (\ref{eq:NotInMB_pd1}) and (\ref{eq:NotInMB_pd2})
  could be extended as follows 
  \begin{eqnarray} 
      f(a') > f(t_{l}) > f(b') \geq f(t_{l+1}), \label{eq:NotInMB_p6.1}    \\
      f(t_{k-1}) \geq f(a') > f(t_{k}) > f(b'). \label{eq:NotInMB_p6.2} 
  \end{eqnarray}  
  
  Since $\{a',b'\} \in MB_p^m(f,[a',b'])$, by the Lemma~\ref{lem:MinJunktSal},
  any other partition in interval $[a',b']$ 
  is not a meaningful partition, thus 
  \begin{equation}
  |f(a')-f(b')|^p = v_p(f,[a',b']) > v_p(f,[a',t_{k}]) + v_p(f,[t_{k},t_{l}]) + v_p(f,[t_{l},b']). 
  \end{equation}
  According to Lemma~\ref{lm:element_properties}(\ref{lm:ep_g}), from the following proposition follows
  \begin{eqnarray*} 
    |f(a')-f(b')|^p &>& |f(a')-f(t_{k})|^p + v_p(f,[t_k,t_l]) +  |f(t_{l})-f(b')|^p \\
    |f(a')-f(t_l)+f(t_l)-f(b')|^p &>& |f(a')-f(t_{k})|^p + v_p(f,[t_k,t_l]) +  |f(t_{l})-f(b')|^p.  \label{eq:NotInMB_p7} 
  \end{eqnarray*}
  From the (\ref{eq:NotInMB_p6.1}) the following inequalities holds
  \begin{eqnarray*}
    f(a')-f(t_l) &>& 0, \\
    f(t_{l})-f(t_{l+1}) \geq f(t_l)-f(b') &>& 0.
  \end{eqnarray*} 
  Therefore, we can use Corollary~\ref{cor:convex}. According to it,
  from the inequality (\ref{eq:NotInMB_p7}) follows  
  \begin{eqnarray*}
    |f(a')-f(t_l)+f(t_l)-f(t_{l+1})|^p &>& |f(a')-f(t_{k})|^p + v_p(f,[t_k,t_l]) +  |f(t_{l})-f(t_{l+1})|^p \\
    |f(a')-f(t_{l+1})|^p &>& |f(a')-f(t_{k})|^p + v_p(f,[t_k,t_l]) +  v_p(f,[t_l,t_{l+1}]). 
  \end{eqnarray*} 
  Absolutely symmetric argument could be used in other direction. Firstly lets modify last inequality
  $$  |f(a')-f(t_k)+f(t_k)-f(t_{l+1})|^p > |f(a')-f(t_{k})|^p + v_p(f,[t_k,t_l]) +  v_p(f,[t_l,t_{l+1}]), $$
  then form the  (\ref{eq:NotInMB_p6.2}) holds the following inequalities
  \begin{eqnarray*}
    f(t_k)-f(t_{l+1}) &>& 0, \\
    f(t_{k-1})-f(t_{k}) \geq f(a')-f(t_k) &>& 0.
  \end{eqnarray*} 

  Thus, from Corollary~\ref{cor:convex} we get
  \begin{eqnarray*}
    |f(t_{k-1})-f(t_k)+f(t_k)-f(t_{l+1})|^p&>&|f(t_{k-1})-f(t_{k})|^p+v_p(f,[t_k,t_l])+v_p(f,[t_l,t_{l+1}]) \\
    |f(t_{k-1})-f(t_{l+1})|^p &>& v_p(f,[t_{k-1},t_{k}]) + v_p(f,[t_k,t_l])+v_p(f,[t_l,t_{l+1}])
  \end{eqnarray*}  
  Finlay, using Lemma~\ref{prop:pvarSubset} we conclude that
  $$|f(t_{k-1})-f(t_{l+1})|^p > v_p(f,[t_{k-1},t_{l+1}]).$$
  This contradicts with the definition of $p$-variation.  
\end{proof}


%%% VIP: In meaningless => meaningless %%%
% Status: OK
\begin{proposition}\label{prop:non_non}
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM,
  $1 \leq p < \infty$ and $x \in [a,b]$. Then the proposition
  \begin{equation}\label{eq:NN1}
    T:=\exists (a',b') \in \left\{ (u,v) \in \mathbb{R}^2: x \in [u,v] \subset [a,b]\right\}: x \notin \overline{MB}_p(f,[a',b'])
  \end{equation}
  is equivalent to
  \begin{equation}\label{eq:NN2}
   S:= x \not\in \overline{MB}_p(f,[a,b]).
  \end{equation}
\end{proposition}
\begin{proof}
  Sufficiency. Suppose $ x \notin \overline{MB}_p(f,[a,b])$. 
  Then the proposition (\ref{eq:NN1}) is obviously true then
  $[a',b'] = [a,b]$.
  
  Necessity.
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM,
  $1 \leq p < \infty$, $x \in [a,b]$ and (\ref{eq:NN1}) holds.

  
  Let $\{t_i\}_{i=0}^n \in MB_{p}^m(f,[a',b'])$. 
  Since $x \in [a',b']$, then $\exists j: x \in (t_{j-1},t_j)$. 
  In addition, the Lemma~\ref{prop:MaxKapaJunkMax} ensures that $\{t_{j-1},t_j\} \in MB_{p}^m(f,[t_{j-1},t_j])$.
  Thus, we can apply Proposition~\ref{prop:NotInMB} for interval $[a,b]$ and point $x$. 
  According to it $x \notin \overline{MB}_p(f,[a,b])$.
\end{proof}
\begin{corollary}\label{cor:non_non}
  Since $(T \Leftrightarrow S) \Leftrightarrow (\neg T \Leftrightarrow \neg S) $, we get
  $$ x \in \overline{MB}_p(f,[a,b]) \Leftrightarrow \forall [a',b'] \subset [a,b], x \in [a',b']: x \in \overline{MB}_p(f,[a',b']). $$
\end{corollary}

\subsection{Extra conclusions}

%%% The uniqueness of partition with maximum size %%%
% Status: OK
\begin{proposition}\label{prop:E1Kappa}
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM,
  $1 \leq p < \infty$. Let $\kappa_{ab} \in MP_{p}^m(f,[a,b])$, then
  \begin{equation}
  x \in \overline{MB}_{p}(f,[a,b]) \Leftrightarrow  x \in \kappa_{ab}.
  \end{equation}
\end{proposition}
\begin{proof}
  Sufficiency. If $x \in \kappa_{ab} \in MP_{p}^m(f,[a,b])$, then
  $x \in \overline{MB}_{p}(f,[a,b])$ according to the definition of  
  $\overline{MB}_{p}(f,[a,b])$ (see~Definition~\ref{def:MB}).
  
  Necessary. Suppose to the contrary that $x \in \overline{MB}(f,[a,b])$, 
  but $x \not \in \kappa_{ab} \in MB_{p}^m(f,[a,b])$.
  The points of the partition $\kappa_{ab}$ will be denoted $t_i$, i.e. $\kappa_{ab}=\{t_i\}_{i=0}^n$.
  Then
  $$ \exists j\in\{1,2,\dots,n\}:x \in (t_{j-1},t_j).$$
  Since $\{(t_{j-1},t_j\} \in MB_p^m(f,[t_{j-1},t_j])$,  $x \notin \overline{MB}_p(f,[t_{j-1},t_j])$.
  Therefore, we can apply Proposition~\ref{prop:non_non}. From it follows that  
  $$ x \notin \overline{MB}_{p}(f,[a,b]).$$
  This is the contradiction that proves the proposition.
\end{proof}
\begin{corollary} 
  According to the definition of MB (see~Definition~\ref{def:MB}),
  from the last proposition directly follows that  
  $$\forall \kappa \in MB_{p}(f,[a,b]): \kappa \subset \kappa_{ab}, $$
  this means
  $$\exists!\kappa_{ab} \in MB_{p}^m(f,[a,b]). $$
\end{corollary} 


%%% Monotonicity of p-variation sum function %%%
% Status: ???
\begin{lemma}\label{prop:Pmonoton}
  Let $C\geq0$ and $c_i\geq0,\;i=1,\dots,n$. Suppose $1 \leq p < q < \infty$. Then the implication holds
  $$C^p > \sum_{i=1}^n c_i^p  \Rightarrow C^q > \sum_{i=1}^n c_i^q. $$ 
\end{lemma}
\begin{proof}
  Let denote the function $f(p)$ as 
  $$f(p) = C^p - \left[ \sum_{i=1}^n c_i^p \right].$$
  The derivative of function $f$ is
  \begin{eqnarray*}
    f'(p) &=& C^p\log{p} - \left[ \sum_{i=1}^n c_i^p \log{p} \right] \\
            &=& \left(C^p - \left[ \sum_{i=1}^n c_i^p \right]\right)\log{p} .
  \end{eqnarray*}
  Thus, if $1 \leq p < \infty$ and $C^p > \sum_{i=1}^n c_i^p$, then 
  $f$ derivative is non negative. This means that function $f$ is non decreasing, 
  whereas this proof the Lemma~\ref{prop:Pmonoton}
\end{proof}

%%% The monotonicity of partition according to p %%%
% Status: OK
\begin{proposition}\label{prop:MBMonoton} 
  Suppose $f:[a,b] \rightarrow \mathbb{R}$ is CPM and 
  $1 \leq p < q < \infty$. Then
  $$\overline{MB}_{q}(f,[a,b]) \subset \overline{MB}_{p}(f,[a,b]). $$
\end{proposition}
\begin{proof}
  Suppose to the contrary that
  \begin{equation*}
  \exists x \in[a,b]:x \in \overline{MB}_{q}(f,[a,b]),\,x \notin \overline{MB}_{p}(f,[a,b]).   
  \end{equation*}

  Let $\{t_i\}_{i=0}^n \in MB_p^m(f,[a,b])$. 
  Because $x \in [a,b]$ and $x \notin \overline{MB}_{p}(f,[a,b])$, then
  \begin{equation}\label{eq:xinj}
    \exists j \in\{1,2,\dots,n\}:x\in (t_{j-1},t_j). 
  \end{equation}
  Let arbitrary choose $\kappa \in BP(f,(a,b))$.
  Then according to Lemma~\ref{lem:MinJunktSal}, the following inequality holds
  \begin{equation*}
    |f(t_{j-1})-f(t_{j})|^p > s_p(f, \kappa).
  \end{equation*}
  Whereas, according to Lemma~\ref{prop:Pmonoton},
  \begin{equation*}
    |f(t_{j-1})-f(t_{j})|^q > s_q(f, \kappa).
  \end{equation*} 
  This means that
  $$\{t_{j-1}, t_j \} \in MB_q^m(f,[t_{j-1},t_j]).$$ 
  Finlay, from the Proposition~ \ref{prop:NotInMB} follows that $x \notin \overline{MB}_q(f,[a,b])$,
  but this contradicts the assumptions.
\end{proof}
  
\section{p-variation calculus}  
  
This chapter will present the algorithm that calculates 
$p$-variation for the sample 
(see Def.~\ref{def:pvarseq}).
Nonetheless, this algorithm could be used to calculate
the $p$-variation for arbitrary piecewise monotone function. 
This algorithm will be called \emph{pvar}. 
It is already realised in the R (see~\cite{R}) package \emph{pvar} and
is publicly available on CRAN\footnotemark.
\footnotetext{
http://cran.r-project.org/web/packages/pvar/index.html
}

Suppose $X=\{X_{i}\}_{i=0}^{n}$ is any real-value sequence of numbers. 
We will call such sequence a \emph{sample}, 
whereas $n$ will be referred to as a \emph{sample size}.
The formal definition of $p$-variation 
of the sample is given in Definition~\ref{def:pvarseq}, but 
it is more intuitive to consider a sample as 
continuous piecewise monotone (CPM) function, namely,
Proposition~\ref{cor:PM2CPM} states that if $p\geq1$ then
\begin{equation}
  v_p(X) = v_p(L_X(t),[0,n]),
\end{equation}
where $L_X(t)$ is piecewise linear function 
connecting sample points (Def.~\ref{def:poligon}).
Since $L_X(t)$ is CPM, all the properties proved in this chapter are
applicable to it.

On the other hand, the algorithm does not use
$L_X(t)$ function directly, but it actually operates the
sample $X$. Therefore, in the context of algorithm
it is more convenient to use the sample $X$ rather then the function $L_X(t)$. Thus in this part we will be using $X$, but please don't be mislead then we will refer to properties of p-variation 
that were proved to functions. In that case we actually have in mind function $L_X(t)$. 

The $L_X(t)$ is CPM and all its break points could be 
only at points $t=0,1,\dots,n$, i.e. at points where 
 $L_X(t)=X_0,X_1,\dots,X_n$.
Therefore, according to Prop.~\ref{prop:pvar-max},
 the $p$-variation of the sample could be expressed as
\begin{equation}
v_p(X) = \max\left\{ \sum_{i=1}^k |X_{j_i} - X_{j_{i-1}}|^p :
  0=j_0<\dots<j_k=n,\; k=1,\dots,n  \right\}.
\end{equation}


It is worth noting, 
that the procedure \emph{pvar} could be used to calculate
the $p$-variation of any piecewise monotone function.
Let assume $f$ is any piecewise monotone function.  
According to definition (see~\ref{def:PM}) 
there are points $a=x_1<\dots<x_n=b$ for some finite $n$ such 
that $f$ is monotone on each interval $[x_{j-1},x_j],\;j=1,2,\dots,n$.
Let the sample $X$ contain the values of the function $f$ 
at the points $\{x_{i}\}_{i=0}^{n}$, namely,
$X=\{X_{i}\}_{i=0}^{n}:=\{f(x_{i})\}_{i=0}^{n}$.
It is straight forward to see that 
$f \stackrel{PM}{=} L_X$, therefore, if $p \geq 1$ then $v_p(X)=v_p(L_X)=v_p(f)$.


\subsection{Main function}

The procedure \emph{pvar} that calculates
$p$-variation will be presented here. Firstly,
we will introduce the main schema, further, each step will
be discussed in more details. 

The main principal of the whole procedure is to identify 
meaningless points using known properties of p-variation.
If a single point $X_i$ is identified 
as meaningless, then we could exude it from further consideration.
As long as $X_i$ is meaningless, the actual value of 
$X_i$ has no effect on $p$-variation since $X_i$ do not participate 
in the sum of p-variation. Actually, $X_i$ could be ignored,
but it is more convenient to drop it form the sample,
because it is hard to apply properties then not all points are under consideration. 
The \emph{drop} operation means that we 
updating sample $X$ with new sample $X'$ which do not have
$X_i$ element, namely,  
$$
\{X'_{i}\}_{i=0}^{n-1}:=\{X_0,\dots,X_{i-1},X_{i+1},\dots,X_n\}.
$$


The most important properties which were used in algorithm are
 ... ??? 
Later on, we will
discus in great detail how we actually using them.
The main steps in \emph{pvar} procedure
goes as follows.


\paragraph{Procedure \emph{pvar}.}
Input: sample $X$, scalar $p$.

\begin{enumerate}
  \item \emph{Removing monotonic points}. According to proposition ???
  all points that are not the end of monotonic interval could be excluded 
  from further consideration. 
  
  \item \emph{Checking all small intervals}. Every small intervals are
    checked if it is possible to identify meaningless points. All points
    that are found to be meaningless are excluded. 
    This operation is based on proposition ??? which states that 
    if point is not meaningful in small interval, then it will not be
    meaningful in big interval as well.
 
  \item \emph{Merging small intervals}.  
  
\end{enumerate}

The corresponding psiaudocode of the main functions goes as follows
\begin{lstlisting}
pvar <- function(x, p){
  partition <- Remove_Monotonic_Points(x) 
  partition <- Test_Points_In_Small_Intervals(partition, p, LSI = 3) 
  partition <- Merge_Small_Intervals(partition, p, LSI=3+1)
  pvar <- sum(abs(diff(partition))^p)  
  return(pvar)
}
\end{lstlisting}
  
\subsection{Detail explanation}

\subsubsection{Removing monotonic points}

According to Proposition~\ref{prop:sup_in_PM}
the p-variation is achieved 
on the partition of monotonic intervals. Therefore the points that are not the end of monotonic interval could be drop out. 

There are multiple options to perform this checking. The method
that was actuality applied involves two steps:

\begin{enumerate}
  \item \emph{Removing constant intervals.} 
  If  $X_{t}=X_{t+1},\;t=1,\dots,n-1$ then $X_t$ is removed
  since both points $X_{t}$ and $X_{t+1}$ cannot be in break points
  partition. Let Label the new sample as  $\{Y_{i}\}_{i=0}^{m}$ .
  
  \item \emph{Finding break point.}  
  If $\Delta Y_{t}$ and $\Delta Y_{t+1}$ ($t=1,\dots,m-1$)
  has alternating sign, then point $Y_t$ is considered 
  to be break point. In addition points $Y_0$ and $Y_m$ 
  is also the break points since end points of 
  the interval is always included in partition (see
  Definition~\ref{def:pp}). All other point are identified as
  meaningless and removed from sample.  

\end{enumerate}


This procedure can by performed very quickly, since it does not include
any interdependent checking and could be done with vectorised functions.
In \emph{pvar} package all break points could be found with \emph{ChangePointsId} function.



\subsubsection{Test points in small intervals}
Todo: papildyti vien savybe su alternuojanciais intervlais

\begin{lemma}\label{lm:evenkapa}
Let $f:[a,b] -> $ be CPM and $\kappa \in X(f)$. If $|\kappa|$ is even
then function $f$ has at least one inner meaningful break point.
\end{lemma}
\begin{proof}
Didejantys, paejantys intervalai.
tarki, kad didejantys, tuomet nei a nei b nera maksimumas.
Maksimumas yra kakur ir jis yra reiksmingas.
\end{proof}



\begin{lemma}\label{lm:samllincrease}
Turim skaidini, ir ysa istirti visi mazesnieji intervalai iki $n-1$
tada pilnas intervalas yra arba visi arba nei vienas.

\end{lemma}
\begin{proof}
Pritaikom skaidimo teorema.
\end{proof}


Proposition~\ref{prop:non_non} is very important for speeding up the calculus of p-variation. It states that if the point was not significant in any small interval, then it will not be significant in the full sample as well. Moreover, Proposition~\ref{prop:pvar_sum_x}, Lemmas ?? and ?? gives an effective 
way to identify some meaningless points.  
Those property allows to drop significant amount of points using quite simple operations.

Suppose $X$ is a sample without monotonic points. 
Let consider any small interval with $m+1$ points ($m=2,\dots,n-1$), 
namely, lets examine a sub-sample 
$\{X_{i}\}_{i=j}^{j+m}$
for any $j=0,...,n-m$.
Based on Proposition~\ref{prop:pvar_sum_x}, if 
\begin{equation}\label{eq:dropsamll1}
  \sum_{i=j+1}^{j+m} |X_{i}-X_{i-1}|^p < |X_j-X_{j+m}|^p,
\end{equation}
then partition $\{j,\dots,j+m\}$ could not be meaningful in interval
$[j,j+m]$, therefore, some of the points $\{X_{i}\}_{i=j+1}^{j+m-1}$
must be meaningless. Those meaningless points can be easily identify 
if we systemically check all intervals starting from small $m$.

If $m=2$ then $|\{X_{i}\}_{i=j}^{j+2}|=2$, thus according to
Lemma~\ref{lm:evenkapa}, $\{X_{i}\}_{i=j}^{j+m}$ has at least one
inner significant point. Since it only has one inner point, then this point must be significant. So, we don't need to do any checkings here.

If $m=3$ and (\ref{eq:dropsamll1}) holds,
then at least one 
point must be insignificant. 
Moreover, according to Lemma~\ref{lm:samllincrease}, 
in this case both middle points $X_{t+1}$ and $X_{t+2}$ 
must be meaningless. 

So, some insignificant points could be identified by 
applying this kind of checking for all sub-samples
$\{X_{i}\}_{i=j}^{j+3},\;j=0,...,n-3$. 
Then all identified meaningless points 
could be droped out.
As a result, the whole sample changes,  
hence, 
we can apply the same procedure again and try to find 
even more meaningless points. 
We should repeat the iterations 
until no new meaningless points are 
identified.

If $m=4$ then $|\{X_{i}\}_{i=j}^{j+2}|$ is even, 
thus, according to Lemma~\ref{lm:evenkapa}, 
$\{X_{i}\}_{i=j}^{j+m}$ has at least one
inner significant point. So, all inner points are significant, 
based on Lemma~\ref{lm:evenkapa}. We can conclude, that 
this argument holds in all cases, then $m$ is even, so 
we don't need to check it any more.

So, the can go further and apply same checking with
$m=5$. Suppose all sub-samples
 $\{X_{i}\}_{i=j}^{j+3},\;j=0,...,n-3$ are already 
 checked.
 If (\ref{eq:dropsamll1}) holds, then based on
 the same Lemma, all middle points
$X_{t+1}$, $X_{t+2}$, $X_{t+3}$  and $X_{t+4}$ are  
identified as meaningless and could be dropped out.
If we want to apply this checking in new itaration,
then we should start checking from $m=3$ again, because
we must make sure that all sub-samples
 $\{X_{i}\}_{i=j}^{j+3},\;j=0,...,n-3$ are already 
 checked if we want to apply Lemma ??

We can continue checking by this principle, and actually find 
p-variation. But it is not effective way, because
in any case of drop out we should go back and start checking
from $m=3$, so, it is actually effective for small $m$. From Monte-Carlo experiment we made
a recommendation to check up till $m=7$.

The final psiaudocode of this procedure is given below
\begin{lstlisting}

SET dum_X to NULL
WHILE dum_X is not equal to X
  SET dum_X	= X
  SET d=3
  CHECK all sub-samples with m=d 
  UPDATE X by dropping all meaningless points
  WHILE dum_X is equal to X	
    SET d = d + 2
    CHECK all sub-samples with m=d points
    UPDATE x by dropping all meaningless points
  ENDWHILE  
ENDWHILE

\end{lstlisting}

\subsubsection{Merging small intervals}

\paragraph{Adding an extra point to interval}

Let suppose ...
Then $x_0$ could make a f-join with any other partition point.

Test reasinable posibilities. 
If find - delete all midpoints

\paragraph{Merge two intervals}


\begin{lstlisting}

1. Find potential points from one side an the other

2. Merging
for i in 
  AddPoint(i)
EndFor

\end{lstlisting}


\paragraph{Merging all small intervals}


\begin{lstlisting}

while the length of in > 1
  
  for  
    int[i] = merge(int[i], int[i+1])
    i+2;
  end for
  delete all even int
  
  

end 


\end{lstlisting}

\section{Conclusion}
  
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\begin{thebibliography}{99}  
  \bibitem{Qian} J. Qian. The $p$-variation of Partial Sum Processes
  and the Empirical Process // Ph.D. thesis, Tufts University, 1997.
  
   \bibitem{R} R
  
\end{thebibliography}






\end{document}
